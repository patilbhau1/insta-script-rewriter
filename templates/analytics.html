{% extends "base.html" %}

{% block title %}Analytics - Script Rewriter{% endblock %}

{% block content %}
<div class="container">
    <header class="page-header">
        <h1>ğŸ“ˆ Analytics</h1>
        <p class="subtitle">Detailed insights into your script generation</p>
    </header>

    <!-- Overview Stats -->
    <div class="analytics-section">
        <h2>ğŸ“Š Overview</h2>
        <div class="stats-grid">
            <div class="stat-card large">
                <h4>Total Scripts Generated</h4>
                <div class="stat-value">{{ stats.total_scripts }}</div>
                <p class="stat-trend">All time</p>
            </div>
            <div class="stat-card large">
                <h4>Average Transcription</h4>
                <div class="stat-value">{{ stats.avg_transcription_length }}</div>
                <p class="stat-trend">characters</p>
            </div>
            <div class="stat-card large">
                <h4>Average Script Length</h4>
                <div class="stat-value">{{ stats.avg_script_length }}</div>
                <p class="stat-trend">characters</p>
            </div>
        </div>
    </div>

    <!-- Source Distribution -->
    <div class="analytics-section">
        <h2>ğŸ“± Source Distribution</h2>
        <div class="chart-container">
            <div class="chart-bar-group">
                <div class="chart-bar-item">
                    <div class="chart-label">Instagram Links</div>
                    <div class="chart-bar">
                        <div class="chart-fill instagram" style="width: {{ (stats.instagram_count / stats.total_scripts * 100) if stats.total_scripts > 0 else 0 }}%"></div>
                    </div>
                    <div class="chart-value">{{ stats.instagram_count }}</div>
                </div>
                <div class="chart-bar-item">
                    <div class="chart-label">File Uploads</div>
                    <div class="chart-bar">
                        <div class="chart-fill upload" style="width: {{ (stats.upload_count / stats.total_scripts * 100) if stats.total_scripts > 0 else 0 }}%"></div>
                    </div>
                    <div class="chart-value">{{ stats.upload_count }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="analytics-section">
        <h2>ğŸ• Recent Activity (Last 7 Days)</h2>
        {% if stats.recent_activity %}
        <div class="activity-timeline">
            {% for activity in stats.recent_activity[:10] %}
            <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                    <div class="timeline-time">{{ activity.timestamp[:19].replace('T', ' ') }}</div>
                    <div class="timeline-title">Script Generated</div>
                    <div class="timeline-desc">{{ activity.brand_input[:60] }}...</div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="empty-message">No activity in the last 7 days</p>
        {% endif %}
    </div>

    <!-- Performance Metrics -->
    <div class="analytics-section">
        <h2>âš¡ Performance Metrics</h2>
        <div class="metrics-grid">
            <div class="metric-box">
                <div class="metric-icon">ğŸ¯</div>
                <div class="metric-content">
                    <h4>Success Rate</h4>
                    <div class="metric-value">100%</div>
                    <p>All generations completed</p>
                </div>
            </div>
            <div class="metric-box">
                <div class="metric-icon">â±ï¸</div>
                <div class="metric-content">
                    <h4>Avg. Processing Time</h4>
                    <div class="metric-value">~90s</div>
                    <p>Per video analysis</p>
                </div>
            </div>
            <div class="metric-box">
                <div class="metric-icon">ğŸ’¾</div>
                <div class="metric-content">
                    <h4>Total Data</h4>
                    <div class="metric-value">{{ (stats.avg_transcription_length + stats.avg_script_length) * stats.total_scripts // 1000 }}KB</div>
                    <p>Generated content</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
